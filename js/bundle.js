!function i(a,o,r){function d(n,t){if(!o[n]){if(!a[n]){var e="function"==typeof require&&require;if(!t&&e)return e(n,!0);if(c)return c(n,!0);throw new Error("Cannot find module '"+n+"'")}var s=o[n]={exports:{}};a[n][0].call(s.exports,function(t){var e=a[n][1][t];return d(e||t)},s,s.exports,i,a,o,r)}return o[n].exports}for(var c="function"==typeof require&&require,t=0;t<r.length;t++)d(r[t]);return d}({1:[function(t,e,n){"use strict";var d={square:document.querySelectorAll(".grid div"),ships:[{id:"ManoWar",cordsY:0,cordsX:0,res:3},{id:"Destroyer",cordsY:0,cordsX:0,res:2},{id:"Silence",cordsY:0,cordsX:0,res:2}],init:!1,fire:function(a,o){function r(t,e){return!o.classList.contains("hit")&&!o.classList.contains("miss")&&(t.res--,0===t.res?(t.sank=!0,c.damage(e,"sunk"),c.displayMessage("You sank the battleship "+t.id)):(c.damage(e,"hit"),c.displayMessage(" The "+t.id+" has been hit !  ")),c.displayHit(a),d.isSunk()&&(c.displayMessage(" Congratulations! You sank all battleships "),setTimeout(function(){c.displayEndMessage("Mission Complete"),c.finish(),c.end(d.getScore.score())},3e3)),!0)}!function(){for(var t=document.getElementById("radar-grid").firstElementChild.offsetWidth/2.5,e=radar.getElementsByClassName(a)[0],n=e.offsetTop+e.offsetHeight/2,s=e.offsetLeft+e.offsetWidth/2,i=0;i<d.ships.length;i++)d.ships[i].cordsY=c.navios[i].offsetTop+c.navios[i].offsetHeight/2,d.ships[i].cordsX=c.navios[i].offsetLeft+c.navios[i].offsetWidth/2,d.ships[i].cordsY-t<n&&n<d.ships[i].cordsY+t&&d.ships[i].cordsX-t<s&&s<d.ships[i].cordsX+t&&r(d.ships[i],c.navios[i]);!void(o.classList.contains("miss")||o.classList.contains("hit")||(c.displayMiss(a),c.displayMessage("You missed.")))}()},isSunk:function(){for(var t=0;t<d.ships.length;t++)if(!d.ships[t].sank)return!1;return!0},getScore:{score:function(){var e={shotsHit:0,shotsMiss:0,shipsSunk:0,time:0,total:0};if(!d.init)return!1;var t=document.getElementById("min").firstChild.data,n=document.getElementById("sec").firstChild.data;return e.time=60*parseFloat(t)+parseFloat(n),d.square.forEach(function(t){t.classList.contains("hit")?e.shotsHit++:t.classList.contains("miss")&&e.shotsMiss++}),d.ships.forEach(function(t){0===t.res&&e.shipsSunk++}),e.total=e.time+25*e.shotsHit+70*e.shipsSunk-10*e.shotsMiss,e}}},c={navios:document.querySelectorAll(".ships"),message:document.getElementById("messageArea"),messageEnd:document.getElementById("messageEnd"),antena:document.querySelector(".antena"),mapa:document.getElementById("radar"),cronometro:document.getElementById("countDown"),interval:null,points:document.querySelectorAll(".point-list-item span"),overlay:document.getElementById("overlay"),modal:document.getElementById("modal"),list:document.getElementsByClassName("point-list-item"),rankWrap:document.getElementById("rank-wrap"),rankList:document.getElementById("rank-list"),start:function(){var t=this;d.init=!0,this.mapa.classList.add("radar-map"),l.btnStart.classList.add("is-active"),l.btnStart.disabled=!0,l.btnRank.disabled=!0,l.input.disabled=!1,l.input.focus(),this.countDown(),setTimeout(function(){t.antena.classList.remove("hidden"),l.btnStop.disabled=!1},5e3)},stop:function(){window.location.reload()},finish:function(){clearInterval(c.interval),c.mapa.querySelector(".antena").style.animationPlayState="paused",c.cronometro.style.animationPlayState="paused",l.btnStart.classList.remove("is-active"),l.input.disabled=!0,l.btnStop.disabled=!0,c.navios.forEach(function(t){t.style.animationPlayState="paused"}),c.cronometro.classList.remove("is--time-over"),c.end(d.getScore.score())},generateShips:function(){var t=function(t){for(var e=[],n=0;n<=t;n++)e.push(n);return e.sort(function(t,e){return Math.round(2*Math.random())-1}),e.splice(0,t+1)}(2);c.navios[t[0]].style.animationDirection="alternate-reverse";var e=0,n=setInterval(function(){c.navios[t[e]].classList.remove("hidden"),++e===c.navios.length&&clearInterval(n)},7e3)},displayMessage:function(t){this.message.textContent=t},displayHit:function(t){document.getElementById(t).classList.add("hit")},displayMiss:function(t){document.getElementById(t).classList.add("miss")},displayEndMessage:function(t){this.messageEnd.textContent=t},damage:function(t,e){"hit"===e&&(t.classList.add("hitted"),setTimeout(function(){t.classList.remove("hitted")},3e3)),"sunk"===e&&t.classList.add("sunk")},countDown:function(){var t,e,n=this;t=30,e=2,c.interval=setInterval(function(){0==t&&(e--,t=60),document.getElementById("min").textContent=e<10?"0"+e:e,t--,document.getElementById("sec").textContent=t<10?"0"+t:t,0==e&&0==t&&(c.finish(),c.displayEndMessage("Mission is Over"))},1e3),setTimeout(function(){n.cronometro.style.visibility="visible"},6e4),setTimeout(function(){n.cronometro.classList.add("is--time-over")},12e4)},end:function(n){c.overlay.classList.add("display"),c.points.forEach(function(t){for(var e in n)t.getAttribute("id")==e&&(t.textContent=n[e])}),setTimeout(function(){c.modal.classList.add("display")},2e3),setTimeout(function(){var t=0,e=setInterval(function(){c.list[t].classList.add("display"),++t===c.list.length&&clearInterval(e)},2e3)},3e3),setTimeout(function(){l.btnStop.disabled=!1,l.btnStop.style.zIndex="9",l.btnRank.disabled=!1,l.addRank()},16e3)},rank:function(){c.modal.classList.contains("display")||c.overlay.classList.toggle("display"),c.rankWrap.classList.toggle("show-rank")},renderRank:function(){c.rankList.innerHTML="",db.collection("rank").orderBy("score","desc").get().then(function(t){t.docs.forEach(function(t){var e=document.createElement("li"),n=document.createElement("strong"),s=document.createElement("span");e.setAttribute("data-id",t.id),n.textContent=t.data().name,s.textContent=t.data().score,n.appendChild(s),e.appendChild(n),c.rankList.appendChild(e)})})}},l={input:document.getElementById("guessInput"),fireButton:document.getElementById("fireButton"),btnStart:document.getElementById("start"),btnStop:document.getElementById("stop"),btnRank:document.getElementById("rank"),rankTitle:document.getElementById("rank-title"),btnSave:document.getElementById("save-score"),inputName:document.getElementById("rank-name"),form:document.getElementById("rank-form"),grid:document.getElementById("grid"),keyPress:function(){this.input.addEventListener("input",function(t){return function(t,e,n){var s,i=n.keyCode;1<t.value.length?(s=t.value.replace(/[^a-g][^0-6]+/g,"").toUpperCase(),t.value=s,l.fireReady(s)):(s=t.value.replace(/[^a-g]+/g,"").toUpperCase(),l.abort(),t.value=s);var a=0,o="",r=s.length;{if(8==i)return!0;for(var d=0;d<=r;d++)"-"==e.charAt(d)||"."==e.charAt(d)||"/"==e.charAt(d)||"("==e.charAt(d)||")"==e.charAt(d)||" "==e.charAt(d)?(o+=e.charAt(d),r++):(o+=s.charAt(a),a++);return t.value=o,!0}}(this,"00",t)}),this.grid.addEventListener("touchend",function(t){var e=t.target.getAttribute("id");d.fire(e,t.target)})},fireReady:function(t){if(t){var e=document.getElementById(t);if(e.classList.contains("hit")||e.classList.contains("miss"))c.displayMessage("Marked Field"),l.abort(fireEnter);else{var n=function(t){13===t.keyCode&&fireButton.click()};fireButton.disabled=!1,fireButton.classList.add("is--enabled"),l.input.addEventListener("keypress",n),fireButton.onclick=function(){var t=l.input.value;e=document.getElementById(t),d.fire(t,e),l.abort(n)}}return!1}},abort:function(t){fireButton.disabled=!0,fireButton.classList.remove("is--enabled"),l.input.removeEventListener("keypress",t),l.input.value="",l.input.focus()},addRank:function(){l.form.classList.add("fade-in"),l.btnSave.disabled=!1,l.inputName.disabled=!1,l.inputName.addEventListener("focusin",function(){l.inputName.classList.remove("is-invalid")}),l.form.addEventListener("submit",function(t){t.preventDefault();var s=d.getScore.score().total,i=l.inputName.value;if(console.log("Without trim"+i),console.log("Input "+i.trim().toUpperCase()),!(0==i.length||20<i.length))return 600<s||!d.init?(i="Invalid Score",l.inputName.classList.add("is-invalid"),void setTimeout(function(){c.stop()},5e3)):void db.collection("rank").get().then(function(t){for(var e=t.docs,n=0;n<e.length;n++){if(e[n].data().name.toUpperCase()==i.trim().toUpperCase()&&e[n].data().score>=s)return console.log("data Name :"+e[n].data().name.toUpperCase()),i="Can't be done",void l.inputName.classList.add("is-invalid");if(e[n].data().name.toUpperCase()==i.trim().toUpperCase()&&e[n].data().score<s)return db.collection("rank").doc(e[n].id).update({score:s}),l.form.classList.remove("fade-in"),void setTimeout(function(){l.form.remove(),c.renderRank()},2e3);if(n+1===e.length)return db.collection("rank").add({name:i,score:s}),l.form.classList.remove("fade-in"),void setTimeout(function(){l.form.remove(),c.renderRank()},2e3)}});l.inputName.classList.add("is-invalid")})}};function s(){c.start(),c.generateShips(),l.keyPress(),l.btnStop.onclick=c.stop}document.addEventListener("DOMContentLoaded",function(){l.btnStart.onclick=s,l.btnRank.onclick=c.rank,l.rankTitle.onclick=c.rank,c.renderRank()})},{}]},{},[1]);