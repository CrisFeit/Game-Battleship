!function i(a,o,r){function d(n,e){if(!o[n]){if(!a[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(c)return c(n,!0);throw new Error("Cannot find module '"+n+"'")}var s=o[n]={exports:{}};a[n][0].call(s.exports,function(e){var t=a[n][1][e];return d(t||e)},s,s.exports,i,a,o,r)}return o[n].exports}for(var c="function"==typeof require&&require,e=0;e<r.length;e++)d(r[e]);return d}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.db=void 0;firebase.initializeApp({apiKey:"AIzaSyAsOckeBlx0P8kg8XRr66XwkIT_T6VHJms",authDomain:"battleship-web-2cde3.firebaseapp.com",databaseURL:"https://battleship-web-2cde3.firebaseio.com",projectId:"battleship-web-2cde3",storageBucket:"battleship-web-2cde3.appspot.com",messagingSenderId:"22663135008",appId:"1:22663135008:web:f6fb7dd2cc5a7aee"});var s=firebase.firestore();n.db=s},{}],2:[function(e,t,n){"use strict";var a=e("./db"),d={square:document.querySelectorAll(".grid div"),ships:[{id:"ManoWar",cordsY:0,cordsX:0,res:3},{id:"Destroyer",cordsY:0,cordsX:0,res:2},{id:"Silence",cordsY:0,cordsX:0,res:2}],init:!1,fire:function(a,o){function r(e,t){return!o.classList.contains("hit")&&!o.classList.contains("miss")&&(e.res--,0===e.res?(e.sank=!0,c.damage(t,"sunk"),c.displayMessage("You sank the battleship "+e.id)):(c.damage(t,"hit"),c.displayMessage(" The "+e.id+" has been hit !  ")),c.displayHit(a),d.isSunk()&&(c.displayMessage(" Congratulations! You sank all battleships "),setTimeout(function(){c.displayEndMessage("Mission Complete"),c.finish(),c.end(d.getScore.score())},3e3)),!0)}!function(){for(var e=document.getElementById("radar-grid").firstElementChild.offsetWidth/2.5,t=radar.getElementsByClassName(a)[0],n=t.offsetTop+t.offsetHeight/2,s=t.offsetLeft+t.offsetWidth/2,i=0;i<d.ships.length;i++)d.ships[i].cordsY=c.navios[i].offsetTop+c.navios[i].offsetHeight/2,d.ships[i].cordsX=c.navios[i].offsetLeft+c.navios[i].offsetWidth/2,d.ships[i].cordsY-e<n&&n<d.ships[i].cordsY+e&&d.ships[i].cordsX-e<s&&s<d.ships[i].cordsX+e&&r(d.ships[i],c.navios[i]);!void(o.classList.contains("miss")||o.classList.contains("hit")||(c.displayMiss(a),c.displayMessage("You missed.")))}()},isSunk:function(){for(var e=0;e<d.ships.length;e++)if(!d.ships[e].sank)return!1;return!0},getScore:{score:function(){var t={shotsHit:0,shotsMiss:0,shipsSunk:0,time:0,total:0};if(!d.init)return!1;var e=document.getElementById("min").firstChild.data,n=document.getElementById("sec").firstChild.data;return t.time=60*parseFloat(e)+parseFloat(n),d.square.forEach(function(e){e.classList.contains("hit")?t.shotsHit++:e.classList.contains("miss")&&t.shotsMiss++}),d.ships.forEach(function(e){0===e.res&&t.shipsSunk++}),t.total=t.time+25*t.shotsHit+70*t.shipsSunk-10*t.shotsMiss,t}}},c={navios:document.querySelectorAll(".ships"),message:document.getElementById("messageArea"),messageEnd:document.getElementById("messageEnd"),antena:document.querySelector(".antena"),mapa:document.getElementById("radar"),cronometro:document.getElementById("countDown"),interval:null,points:document.querySelectorAll(".point-list-item span"),overlay:document.getElementById("overlay"),modal:document.getElementById("modal"),list:document.getElementsByClassName("point-list-item"),rankWrap:document.getElementById("rank-wrap"),rankList:document.getElementById("rank-list"),start:function(){var e=this;d.init=!0,this.mapa.classList.add("radar-map"),l.btnStart.classList.add("is-active"),l.btnStart.disabled=!0,l.btnRank.disabled=!0,l.input.disabled=!1,l.input.focus(),this.countDown(),setTimeout(function(){e.antena.classList.remove("hidden"),l.btnStop.disabled=!1},5e3)},stop:function(){window.location.reload()},finish:function(){clearInterval(c.interval),c.mapa.querySelector(".antena").style.animationPlayState="paused",c.cronometro.style.animationPlayState="paused",l.btnStart.classList.remove("is-active"),l.input.disabled=!0,l.btnStop.disabled=!0,c.navios.forEach(function(e){e.style.animationPlayState="paused"}),c.cronometro.classList.remove("is--time-over"),c.end(d.getScore.score())},generateShips:function(){var e=function(e){for(var t=[],n=0;n<=e;n++)t.push(n);return t.sort(function(e,t){return Math.round(2*Math.random())-1}),t.splice(0,e+1)}(2);c.navios[e[0]].style.animationDirection="alternate-reverse";var t=0,n=setInterval(function(){c.navios[e[t]].classList.remove("hidden"),++t===c.navios.length&&clearInterval(n)},7e3)},displayMessage:function(e){this.message.textContent=e},displayHit:function(e){document.getElementById(e).classList.add("hit")},displayMiss:function(e){document.getElementById(e).classList.add("miss")},displayEndMessage:function(e){this.messageEnd.textContent=e},damage:function(e,t){"hit"===t&&(e.classList.add("hitted"),setTimeout(function(){e.classList.remove("hitted")},3e3)),"sunk"===t&&e.classList.add("sunk")},countDown:function(){var e,t,n=this;e=30,t=2,c.interval=setInterval(function(){0==e&&(t--,e=60),document.getElementById("min").textContent=t<10?"0"+t:t,e--,document.getElementById("sec").textContent=e<10?"0"+e:e,0==t&&0==e&&(c.finish(),c.displayEndMessage("Mission is Over"))},1e3),setTimeout(function(){n.cronometro.style.visibility="visible"},6e4),setTimeout(function(){n.cronometro.classList.add("is--time-over")},12e4)},end:function(n){c.overlay.classList.add("display"),c.points.forEach(function(e){for(var t in n)e.getAttribute("id")==t&&(e.textContent=n[t])}),setTimeout(function(){c.modal.classList.add("display")},2e3),setTimeout(function(){var e=0,t=setInterval(function(){c.list[e].classList.add("display"),++e===c.list.length&&clearInterval(t)},2e3)},3e3),setTimeout(function(){l.btnStop.disabled=!1,l.btnStop.style.zIndex="9",l.btnRank.disabled=!1,l.addRank()},16e3)},rank:function(){c.modal.classList.contains("display")||c.overlay.classList.toggle("display"),c.rankWrap.classList.toggle("show-rank")},renderRank:function(){c.rankList.innerHTML="",a.db.collection("rank").orderBy("score","desc").get().then(function(e){e.docs.forEach(function(e){var t=document.createElement("li"),n=document.createElement("strong"),s=document.createElement("span");t.setAttribute("data-id",e.id),n.textContent=e.data().name,s.textContent=e.data().score,n.appendChild(s),t.appendChild(n),c.rankList.appendChild(t)})})}},l={input:document.getElementById("guessInput"),fireButton:document.getElementById("fireButton"),btnStart:document.getElementById("start"),btnStop:document.getElementById("stop"),btnRank:document.getElementById("rank"),rankTitle:document.getElementById("rank-title"),btnSave:document.getElementById("save-score"),inputName:document.getElementById("rank-name"),form:document.getElementById("rank-form"),grid:document.getElementById("grid"),keyPress:function(){this.input.addEventListener("input",function(e){return function(e,t,n){var s,i=n.keyCode;1<e.value.length?(s=e.value.replace(/[^a-g][^0-6]+/g,"").toUpperCase(),e.value=s,l.fireReady(s)):(s=e.value.replace(/[^a-g]+/g,"").toUpperCase(),l.abort(),e.value=s);var a=0,o="",r=s.length;{if(8==i)return!0;for(var d=0;d<=r;d++)"-"==t.charAt(d)||"."==t.charAt(d)||"/"==t.charAt(d)||"("==t.charAt(d)||")"==t.charAt(d)||" "==t.charAt(d)?(o+=t.charAt(d),r++):(o+=s.charAt(a),a++);return e.value=o,!0}}(this,"00",e)}),this.grid.addEventListener("touchend",function(e){var t=e.target.getAttribute("id");d.fire(t,e.target)})},fireReady:function(e){if(e){var t=document.getElementById(e);if(t.classList.contains("hit")||t.classList.contains("miss"))c.displayMessage("Marked Field"),l.abort(fireEnter);else{var n=function(e){13===e.keyCode&&fireButton.click()};fireButton.disabled=!1,fireButton.classList.add("is--enabled"),l.input.addEventListener("keypress",n),fireButton.onclick=function(){var e=l.input.value;t=document.getElementById(e),d.fire(e,t),l.abort(n)}}return!1}},abort:function(e){fireButton.disabled=!0,fireButton.classList.remove("is--enabled"),l.input.removeEventListener("keypress",e),l.input.value="",l.input.focus()},addRank:function(){l.form.classList.add("fade-in"),l.btnSave.disabled=!1,l.inputName.disabled=!1,l.inputName.addEventListener("focusin",function(){l.inputName.classList.remove("is-invalid")}),l.form.addEventListener("submit",function(e){e.preventDefault();var s=d.getScore.score().total,i=l.inputName.value;if(!(0==i.length||20<i.length))return 600<s||!d.init?(i="Invalid Score",l.inputName.classList.add("is-invalid"),void setTimeout(function(){c.stop()},5e3)):void a.db.collection("rank").get().then(function(e){for(var t=e.docs,n=0;n<t.length;n++){if(t[n].data().name.trim().toUpperCase()==i.trim().toUpperCase()&&t[n].data().score>=s)return i="Can't be done",void l.inputName.classList.add("is-invalid");if(t[n].data().name.trim().toUpperCase()==i.trim().toUpperCase()&&t[n].data().score<s)return a.db.collection("rank").doc(t[n].id).update({score:s}),l.form.classList.remove("fade-in"),void setTimeout(function(){l.form.remove(),c.renderRank()},2e3);n+1===t.length&&(a.db.collection("rank").add({name:i,score:s}),l.form.classList.remove("fade-in"),setTimeout(function(){l.form.remove(),c.renderRank()},2e3))}});l.inputName.classList.add("is-invalid")})}};function s(){c.start(),c.generateShips(),l.keyPress(),l.btnStop.onclick=c.stop}document.addEventListener("DOMContentLoaded",function(){l.btnStart.onclick=s,l.btnRank.onclick=c.rank,l.rankTitle.onclick=c.rank,c.renderRank()})},{"./db":1}]},{},[2]);